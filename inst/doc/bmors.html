<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2019-02-02" />

<title>Fit the Bayesian Multi-Output Regression Stacking model using the maize dataset and apply a random partition cross-validation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Fit the Bayesian Multi-Output Regression Stacking model using the maize dataset and apply a random partition cross-validation</h1>
<h4 class="date"><em>2019-02-02</em></h4>



<p>This example shows how to evaluate prediction accuracy with multiple environments and multiple traits using a random partition as cross validation. The WheatToy data set available in the <code>BMTME</code> package and next is loaded using the <code>data()</code> function as shown below:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(BMTME)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">data</span>(<span class="st">&#39;WheatToy&#39;</span>)</a></code></pre></div>
<p>With this command, you load the following 2 objects into the R environment:</p>
<ul>
<li><code>genoWheatToy</code>: Genomic matrix of the dataset.</li>
<li><code>phenoWheatToy</code>: Phenotypic data from the dataset.</li>
</ul>
<p>Since the data set includes multiple environments and multiple traits, the BMORS model could be used, also, for its implementation we will see three different designs for the linear predictor, Using only the (1) lines effect, (2) Environment and lines effect and (3) Environment, lines effect and the interaction of the environment with the lines effect. Remember that the first step that we need do, is order the dataset as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">phenoWheatToy &lt;-<span class="st"> </span>phenoWheatToy[<span class="kw">order</span>(phenoWheatToy<span class="op">$</span>Env, phenoWheatToy<span class="op">$</span>Gid),]</a></code></pre></div>
<div id="linear-predictor-lines-effect" class="section level2">
<h2>Linear predictor: Lines effect</h2>
<p>To use only the effect of lines in the linear predictor, we will first occupy the matrix design of the lines, we can construct this with the following code,</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">LG &lt;-<span class="st"> </span><span class="kw">cholesky</span>(genoWheatToy)</a>
<a class="sourceLine" id="cb3-2" title="2">ZG &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(phenoWheatToy<span class="op">$</span>Gid))</a>
<a class="sourceLine" id="cb3-3" title="3">Z.G &lt;-<span class="st"> </span>ZG <span class="op">%*%</span><span class="st"> </span>LG</a></code></pre></div>
<p>Once the matrix design has been generated, the linear predictor is constructed, for this purpose, a new object will be created that we will call <code>ETA</code>, that consist of a series of nested lists, where each sub list will contain one of the matrix designs, as well as the model with which this matrix will be modeled. In this case only contain the matrix design of the lines.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">ETA &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">Gen =</span> <span class="kw">list</span>(<span class="dt">X =</span> Z.G, <span class="dt">model =</span> <span class="st">&#39;BRR&#39;</span>))</a></code></pre></div>
<p>Next, we provide some commands as pre-analysis for building the cross validation:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">pheno &lt;-<span class="st"> </span>phenoWheatToy[, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)] <span class="co">#Use only the first trait to do a cv</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">colnames</span>(pheno) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Line&#39;</span>, <span class="st">&#39;Env&#39;</span>, <span class="st">&#39;Response&#39;</span>)</a></code></pre></div>
<p>This is done because the cross validation that will be implemented assumes that for those lines that are selected as missing all traits are missed. The cross validation is implemented with random partitions, with the function: <code>CV.RandomPart()</code>, as shown below,</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">CrossValidation &lt;-<span class="st"> </span><span class="kw">CV.RandomPart</span>(pheno, <span class="dt">NPartitions =</span> <span class="dv">4</span>, <span class="dt">PTesting =</span> <span class="fl">0.2</span>, <span class="dt">set_seed =</span> <span class="dv">123</span>)</a></code></pre></div>
<p>Before making the adjustment of the model, the phenotype matrix is obtained, for this purpose we use the following code,</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">Y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(phenoWheatToy[, <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)])</a></code></pre></div>
<p>Finally, the model is adjusted and for demonstration purposes only 5000 iterations are used to implement the model. In addition, we will show the information of the predictive capacity obtained in each trait for each evaluated environment using the summary() function.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">pm &lt;-<span class="st"> </span><span class="kw">BMORS</span>(Y, <span class="dt">ETA =</span> ETA, <span class="dt">nIter =</span> <span class="dv">5000</span>, <span class="dt">burnIn =</span> <span class="dv">2000</span>, <span class="dt">thin =</span> <span class="dv">2</span>, <span class="dt">progressBar =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb8-2" title="2">              <span class="dt">testingSet =</span> CrossValidation,  <span class="dt">digits =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">summary</span>(pm)</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt;   Environment Trait Pearson SE_Pearson  MAAPE SE_MAAPE</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; 1      Bed2IR  DTHD  0.9674     0.0196 0.2832   0.0762</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; 2      Bed2IR  PTHT -0.0226     0.2762 0.6689   0.0748</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; 3      Bed5IR  DTHD  0.8014     0.1034 0.5040   0.0644</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; 4      Bed5IR  PTHT -0.2934     0.2174 0.6196   0.0501</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; 5        Drip  DTHD  0.9354     0.0376 0.8576   0.0945</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; 6        Drip  PTHT  0.2458     0.1156 0.8944   0.0875</span></a></code></pre></div>
</div>
<div id="linear-predictor-environment-lines" class="section level2">
<h2>Linear predictor: Environment + Lines</h2>
<p>To use only the effect of the environments and lines in the linear predictor, we will first occupy the matrix design of the environment, we can construct this with the following code,</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">Z.E &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(phenoWheatToy<span class="op">$</span>Env))</a></code></pre></div>
<p>Once the matrix design has been generated, the linear predictor is constructed, for this purpose, a new object will be created that we will call <code>ETA2</code>, in this case contain the matrix design of the lines and the matrix design of the environment.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">ETA2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">Env =</span> <span class="kw">list</span>(<span class="dt">X =</span> Z.E, <span class="dt">model =</span> <span class="st">&quot;BRR&quot;</span>),</a>
<a class="sourceLine" id="cb10-2" title="2">             <span class="dt">Gen =</span> <span class="kw">list</span>(<span class="dt">X =</span> Z.G, <span class="dt">model =</span> <span class="st">&#39;BRR&#39;</span>))</a></code></pre></div>
<p>Finally, the model is adjusted and for demonstration purposes only 2000 iterations are used to implement the model. Remember that in the past section we construct the dataset object and the crossvalidation object, and we reuse that objects in this model.</p>
<p>In addition, we will show the information of the predictive capacity obtained in each trait for each evaluated environment using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">pm &lt;-<span class="st"> </span><span class="kw">BMORS</span>(Y, <span class="dt">ETA =</span> ETA, <span class="dt">nIter =</span> <span class="dv">2000</span>, <span class="dt">burnIn =</span> <span class="dv">1000</span>, <span class="dt">thin =</span> <span class="dv">2</span>, <span class="dt">progressBar =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb11-2" title="2">              <span class="dt">testingSet =</span> CrossValidation,  <span class="dt">digits =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">summary</span>(pm)</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt;   Environment Trait Pearson SE_Pearson  MAAPE SE_MAAPE</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt; 1      Bed2IR  DTHD  0.9658     0.0208 0.2790   0.0765</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt; 2      Bed2IR  PTHT -0.0307     0.2904 0.6714   0.0794</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt; 3      Bed5IR  DTHD  0.8027     0.1008 0.5082   0.0610</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt; 4      Bed5IR  PTHT -0.2738     0.2171 0.6118   0.0544</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">#&gt; 5        Drip  DTHD  0.9330     0.0389 0.8569   0.0959</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt; 6        Drip  PTHT  0.1805     0.1096 0.8945   0.0857</span></a></code></pre></div>
</div>
<div id="linear-predictor-env-lines-envxlines" class="section level2">
<h2>Linear predictor: Env + Lines + EnvXLines</h2>
<p>And finally, to use only the effect of the environments and lines with the interaction effect of the environment with the lines in the linear predictor, we will first occupy the matrix design of the interaction, with the following code the construction of all the matrix designs are presented for easy understanding,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Line effect (section 3.1.1)</span></a>
<a class="sourceLine" id="cb12-2" title="2">LG &lt;-<span class="st"> </span><span class="kw">cholesky</span>(genoWheatToy)</a>
<a class="sourceLine" id="cb12-3" title="3">ZG &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(phenoWheatToy<span class="op">$</span>Gid))</a>
<a class="sourceLine" id="cb12-4" title="4">Z.G &lt;-<span class="st"> </span>ZG <span class="op">%*%</span><span class="st"> </span>LG</a>
<a class="sourceLine" id="cb12-5" title="5"></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co"># Environment effect (section 3.1.2)</span></a>
<a class="sourceLine" id="cb12-7" title="7">Z.E &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(phenoWheatToy<span class="op">$</span>Env))</a>
<a class="sourceLine" id="cb12-8" title="8"></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">#Interaction effect</span></a>
<a class="sourceLine" id="cb12-10" title="10">ZEG &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(phenoWheatToy<span class="op">$</span>Gid)<span class="op">:</span><span class="kw">as.factor</span>(phenoWheatToy<span class="op">$</span>Env))</a>
<a class="sourceLine" id="cb12-11" title="11">G2 &lt;-<span class="st"> </span><span class="kw">kronecker</span>(<span class="kw">diag</span>(<span class="kw">length</span>(<span class="kw">unique</span>(phenoWheatToy<span class="op">$</span>Env))), <span class="kw">data.matrix</span>(genoWheatToy))</a>
<a class="sourceLine" id="cb12-12" title="12">LG2 &lt;-<span class="st"> </span><span class="kw">cholesky</span>(G2)</a>
<a class="sourceLine" id="cb12-13" title="13">Z.EG &lt;-<span class="st"> </span>ZEG <span class="op">%*%</span><span class="st"> </span>LG2</a></code></pre></div>
<p>Once the matrix design has been generated, the linear predictor is constructed, for this purpose, a new object will be created that we will call <code>ETA3</code>, in this case contain the effect of environment, lines and the interaction of both.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">ETA3 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">Env =</span> <span class="kw">list</span>(<span class="dt">X =</span> Z.E, <span class="dt">model =</span> <span class="st">&quot;BRR&quot;</span>),</a>
<a class="sourceLine" id="cb13-2" title="2">             <span class="dt">Gen =</span> <span class="kw">list</span>(<span class="dt">X =</span> Z.G, <span class="dt">model =</span> <span class="st">&#39;BRR&#39;</span>),</a>
<a class="sourceLine" id="cb13-3" title="3">             <span class="dt">EnvGen =</span> <span class="kw">list</span>(<span class="dt">X =</span> Z.EG, <span class="dt">model =</span> <span class="st">&quot;BRR&quot;</span>))</a></code></pre></div>
<p>Finally, the model is adjusted and for demonstration purposes only 2000 iterations are used to implement the model. Remember that in the first section we construct the dataset object and the crossvalidation object, and we reuse that objects in this model.</p>
<p>In addition, we will show the information of the predictive capacity obtained in each trait for each evaluated environment using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">pm &lt;-<span class="st"> </span><span class="kw">BMORS</span>(Y, <span class="dt">ETA =</span> ETA3, <span class="dt">nIter =</span> <span class="dv">2000</span>, <span class="dt">burnIn =</span> <span class="dv">1000</span>, <span class="dt">thin =</span> <span class="dv">2</span>, <span class="dt">progressBar =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb14-2" title="2">              <span class="dt">testingSet =</span> CrossValidation,  <span class="dt">digits =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">summary</span>(pm)</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">#&gt;   Environment Trait Pearson SE_Pearson  MAAPE SE_MAAPE</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co">#&gt; 1      Bed2IR  DTHD  0.9734     0.0160 0.2663   0.0403</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co">#&gt; 2      Bed2IR  PTHT  0.2258     0.2801 0.7856   0.0956</span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="co">#&gt; 3      Bed5IR  DTHD  0.8206     0.0876 0.3452   0.0389</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co">#&gt; 4      Bed5IR  PTHT -0.0519     0.2314 0.4870   0.1315</span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="co">#&gt; 5        Drip  DTHD  0.9329     0.0365 0.4848   0.0944</span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co">#&gt; 6        Drip  PTHT  0.2726     0.2585 0.6763   0.0431</span></a></code></pre></div>
<p>It is important to point out that it is possible to obtain a boxplot with the results using the following commands.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>)) <span class="co">#Bottom, Left, Top, Right</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">boxplot</span>(pm, <span class="dt">las =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In this figure we can observe that the best average predictive accuracy is obtained with the trait-environment combination <code>DTHD_Drip</code>, while the lowest average predictive accuracy obtained was in the trait-environment <code>PTHT_Bed5IR</code>.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
